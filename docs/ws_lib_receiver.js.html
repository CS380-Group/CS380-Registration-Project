<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ws/lib/receiver.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ws/lib/receiver.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const { Writable } = require('stream');

const PerMessageDeflate = require('./permessage-deflate');
const {
  BINARY_TYPES,
  EMPTY_BUFFER,
  kStatusCode,
  kWebSocket
} = require('./constants');
const { concat, toArrayBuffer, unmask } = require('./buffer-util');
const { isValidStatusCode, isValidUTF8 } = require('./validation');

const FastBuffer = Buffer[Symbol.species];

const GET_INFO = 0;
const GET_PAYLOAD_LENGTH_16 = 1;
const GET_PAYLOAD_LENGTH_64 = 2;
const GET_MASK = 3;
const GET_DATA = 4;
const INFLATING = 5;
const DEFER_EVENT = 6;

/**
 * HyBi Receiver implementation.
 *
 * @extends Writable
 */
class Receiver extends Writable {
  /**
   * Creates a Receiver instance.
   *
   * @param {Object} [options] Options object
   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether
   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted
   *     multiple times in the same tick
   * @param {String} [options.binaryType=nodebuffer] The type for binary data
   * @param {Object} [options.extensions] An object containing the negotiated
   *     extensions
   * @param {Boolean} [options.isServer=false] Specifies whether to operate in
   *     client or server mode
   * @param {Number} [options.maxPayload=0] The maximum allowed message length
   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or
   *     not to skip UTF-8 validation for text and close messages
   */
  constructor(options = {}) {
    super();

    this._allowSynchronousEvents =
      options.allowSynchronousEvents !== undefined
        ? options.allowSynchronousEvents
        : true;
    this._binaryType = options.binaryType || BINARY_TYPES[0];
    this._extensions = options.extensions || {};
    this._isServer = !!options.isServer;
    this._maxPayload = options.maxPayload | 0;
    this._skipUTF8Validation = !!options.skipUTF8Validation;
    this[kWebSocket] = undefined;

    this._bufferedBytes = 0;
    this._buffers = [];

    this._compressed = false;
    this._payloadLength = 0;
    this._mask = undefined;
    this._fragmented = 0;
    this._masked = false;
    this._fin = false;
    this._opcode = 0;

    this._totalPayloadLength = 0;
    this._messageLength = 0;
    this._fragments = [];

    this._errored = false;
    this._loop = false;
    this._state = GET_INFO;
  }

  /**
   * Implements `Writable.prototype._write()`.
   *
   * @param {Buffer} chunk The chunk of data to write
   * @param {String} encoding The character encoding of `chunk`
   * @param {Function} cb Callback
   * @private
   */
  _write(chunk, encoding, cb) {
    if (this._opcode === 0x08 &amp;&amp; this._state == GET_INFO) return cb();

    this._bufferedBytes += chunk.length;
    this._buffers.push(chunk);
    this.startLoop(cb);
  }

  /**
   * Consumes `n` bytes from the buffered data.
   *
   * @param {Number} n The number of bytes to consume
   * @return {Buffer} The consumed bytes
   * @private
   */
  consume(n) {
    this._bufferedBytes -= n;

    if (n === this._buffers[0].length) return this._buffers.shift();

    if (n &lt; this._buffers[0].length) {
      const buf = this._buffers[0];
      this._buffers[0] = new FastBuffer(
        buf.buffer,
        buf.byteOffset + n,
        buf.length - n
      );

      return new FastBuffer(buf.buffer, buf.byteOffset, n);
    }

    const dst = Buffer.allocUnsafe(n);

    do {
      const buf = this._buffers[0];
      const offset = dst.length - n;

      if (n >= buf.length) {
        dst.set(this._buffers.shift(), offset);
      } else {
        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);
        this._buffers[0] = new FastBuffer(
          buf.buffer,
          buf.byteOffset + n,
          buf.length - n
        );
      }

      n -= buf.length;
    } while (n > 0);

    return dst;
  }

  /**
   * Starts the parsing loop.
   *
   * @param {Function} cb Callback
   * @private
   */
  startLoop(cb) {
    this._loop = true;

    do {
      switch (this._state) {
        case GET_INFO:
          this.getInfo(cb);
          break;
        case GET_PAYLOAD_LENGTH_16:
          this.getPayloadLength16(cb);
          break;
        case GET_PAYLOAD_LENGTH_64:
          this.getPayloadLength64(cb);
          break;
        case GET_MASK:
          this.getMask();
          break;
        case GET_DATA:
          this.getData(cb);
          break;
        case INFLATING:
        case DEFER_EVENT:
          this._loop = false;
          return;
      }
    } while (this._loop);

    if (!this._errored) cb();
  }

  /**
   * Reads the first two bytes of a frame.
   *
   * @param {Function} cb Callback
   * @private
   */
  getInfo(cb) {
    if (this._bufferedBytes &lt; 2) {
      this._loop = false;
      return;
    }

    const buf = this.consume(2);

    if ((buf[0] &amp; 0x30) !== 0x00) {
      const error = this.createError(
        RangeError,
        'RSV2 and RSV3 must be clear',
        true,
        1002,
        'WS_ERR_UNEXPECTED_RSV_2_3'
      );

      cb(error);
      return;
    }

    const compressed = (buf[0] &amp; 0x40) === 0x40;

    if (compressed &amp;&amp; !this._extensions[PerMessageDeflate.extensionName]) {
      const error = this.createError(
        RangeError,
        'RSV1 must be clear',
        true,
        1002,
        'WS_ERR_UNEXPECTED_RSV_1'
      );

      cb(error);
      return;
    }

    this._fin = (buf[0] &amp; 0x80) === 0x80;
    this._opcode = buf[0] &amp; 0x0f;
    this._payloadLength = buf[1] &amp; 0x7f;

    if (this._opcode === 0x00) {
      if (compressed) {
        const error = this.createError(
          RangeError,
          'RSV1 must be clear',
          true,
          1002,
          'WS_ERR_UNEXPECTED_RSV_1'
        );

        cb(error);
        return;
      }

      if (!this._fragmented) {
        const error = this.createError(
          RangeError,
          'invalid opcode 0',
          true,
          1002,
          'WS_ERR_INVALID_OPCODE'
        );

        cb(error);
        return;
      }

      this._opcode = this._fragmented;
    } else if (this._opcode === 0x01 || this._opcode === 0x02) {
      if (this._fragmented) {
        const error = this.createError(
          RangeError,
          `invalid opcode ${this._opcode}`,
          true,
          1002,
          'WS_ERR_INVALID_OPCODE'
        );

        cb(error);
        return;
      }

      this._compressed = compressed;
    } else if (this._opcode > 0x07 &amp;&amp; this._opcode &lt; 0x0b) {
      if (!this._fin) {
        const error = this.createError(
          RangeError,
          'FIN must be set',
          true,
          1002,
          'WS_ERR_EXPECTED_FIN'
        );

        cb(error);
        return;
      }

      if (compressed) {
        const error = this.createError(
          RangeError,
          'RSV1 must be clear',
          true,
          1002,
          'WS_ERR_UNEXPECTED_RSV_1'
        );

        cb(error);
        return;
      }

      if (
        this._payloadLength > 0x7d ||
        (this._opcode === 0x08 &amp;&amp; this._payloadLength === 1)
      ) {
        const error = this.createError(
          RangeError,
          `invalid payload length ${this._payloadLength}`,
          true,
          1002,
          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'
        );

        cb(error);
        return;
      }
    } else {
      const error = this.createError(
        RangeError,
        `invalid opcode ${this._opcode}`,
        true,
        1002,
        'WS_ERR_INVALID_OPCODE'
      );

      cb(error);
      return;
    }

    if (!this._fin &amp;&amp; !this._fragmented) this._fragmented = this._opcode;
    this._masked = (buf[1] &amp; 0x80) === 0x80;

    if (this._isServer) {
      if (!this._masked) {
        const error = this.createError(
          RangeError,
          'MASK must be set',
          true,
          1002,
          'WS_ERR_EXPECTED_MASK'
        );

        cb(error);
        return;
      }
    } else if (this._masked) {
      const error = this.createError(
        RangeError,
        'MASK must be clear',
        true,
        1002,
        'WS_ERR_UNEXPECTED_MASK'
      );

      cb(error);
      return;
    }

    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;
    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;
    else this.haveLength(cb);
  }

  /**
   * Gets extended payload length (7+16).
   *
   * @param {Function} cb Callback
   * @private
   */
  getPayloadLength16(cb) {
    if (this._bufferedBytes &lt; 2) {
      this._loop = false;
      return;
    }

    this._payloadLength = this.consume(2).readUInt16BE(0);
    this.haveLength(cb);
  }

  /**
   * Gets extended payload length (7+64).
   *
   * @param {Function} cb Callback
   * @private
   */
  getPayloadLength64(cb) {
    if (this._bufferedBytes &lt; 8) {
      this._loop = false;
      return;
    }

    const buf = this.consume(8);
    const num = buf.readUInt32BE(0);

    //
    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned
    // if payload length is greater than this number.
    //
    if (num > Math.pow(2, 53 - 32) - 1) {
      const error = this.createError(
        RangeError,
        'Unsupported WebSocket frame: payload length > 2^53 - 1',
        false,
        1009,
        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'
      );

      cb(error);
      return;
    }

    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);
    this.haveLength(cb);
  }

  /**
   * Payload length has been read.
   *
   * @param {Function} cb Callback
   * @private
   */
  haveLength(cb) {
    if (this._payloadLength &amp;&amp; this._opcode &lt; 0x08) {
      this._totalPayloadLength += this._payloadLength;
      if (this._totalPayloadLength > this._maxPayload &amp;&amp; this._maxPayload > 0) {
        const error = this.createError(
          RangeError,
          'Max payload size exceeded',
          false,
          1009,
          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'
        );

        cb(error);
        return;
      }
    }

    if (this._masked) this._state = GET_MASK;
    else this._state = GET_DATA;
  }

  /**
   * Reads mask bytes.
   *
   * @private
   */
  getMask() {
    if (this._bufferedBytes &lt; 4) {
      this._loop = false;
      return;
    }

    this._mask = this.consume(4);
    this._state = GET_DATA;
  }

  /**
   * Reads data bytes.
   *
   * @param {Function} cb Callback
   * @private
   */
  getData(cb) {
    let data = EMPTY_BUFFER;

    if (this._payloadLength) {
      if (this._bufferedBytes &lt; this._payloadLength) {
        this._loop = false;
        return;
      }

      data = this.consume(this._payloadLength);

      if (
        this._masked &amp;&amp;
        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0
      ) {
        unmask(data, this._mask);
      }
    }

    if (this._opcode > 0x07) {
      this.controlMessage(data, cb);
      return;
    }

    if (this._compressed) {
      this._state = INFLATING;
      this.decompress(data, cb);
      return;
    }

    if (data.length) {
      //
      // This message is not compressed so its length is the sum of the payload
      // length of all fragments.
      //
      this._messageLength = this._totalPayloadLength;
      this._fragments.push(data);
    }

    this.dataMessage(cb);
  }

  /**
   * Decompresses data.
   *
   * @param {Buffer} data Compressed data
   * @param {Function} cb Callback
   * @private
   */
  decompress(data, cb) {
    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];

    perMessageDeflate.decompress(data, this._fin, (err, buf) => {
      if (err) return cb(err);

      if (buf.length) {
        this._messageLength += buf.length;
        if (this._messageLength > this._maxPayload &amp;&amp; this._maxPayload > 0) {
          const error = this.createError(
            RangeError,
            'Max payload size exceeded',
            false,
            1009,
            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'
          );

          cb(error);
          return;
        }

        this._fragments.push(buf);
      }

      this.dataMessage(cb);
      if (this._state === GET_INFO) this.startLoop(cb);
    });
  }

  /**
   * Handles a data message.
   *
   * @param {Function} cb Callback
   * @private
   */
  dataMessage(cb) {
    if (!this._fin) {
      this._state = GET_INFO;
      return;
    }

    const messageLength = this._messageLength;
    const fragments = this._fragments;

    this._totalPayloadLength = 0;
    this._messageLength = 0;
    this._fragmented = 0;
    this._fragments = [];

    if (this._opcode === 2) {
      let data;

      if (this._binaryType === 'nodebuffer') {
        data = concat(fragments, messageLength);
      } else if (this._binaryType === 'arraybuffer') {
        data = toArrayBuffer(concat(fragments, messageLength));
      } else if (this._binaryType === 'blob') {
        data = new Blob(fragments);
      } else {
        data = fragments;
      }

      if (this._allowSynchronousEvents) {
        this.emit('message', data, true);
        this._state = GET_INFO;
      } else {
        this._state = DEFER_EVENT;
        setImmediate(() => {
          this.emit('message', data, true);
          this._state = GET_INFO;
          this.startLoop(cb);
        });
      }
    } else {
      const buf = concat(fragments, messageLength);

      if (!this._skipUTF8Validation &amp;&amp; !isValidUTF8(buf)) {
        const error = this.createError(
          Error,
          'invalid UTF-8 sequence',
          true,
          1007,
          'WS_ERR_INVALID_UTF8'
        );

        cb(error);
        return;
      }

      if (this._state === INFLATING || this._allowSynchronousEvents) {
        this.emit('message', buf, false);
        this._state = GET_INFO;
      } else {
        this._state = DEFER_EVENT;
        setImmediate(() => {
          this.emit('message', buf, false);
          this._state = GET_INFO;
          this.startLoop(cb);
        });
      }
    }
  }

  /**
   * Handles a control message.
   *
   * @param {Buffer} data Data to handle
   * @return {(Error|RangeError|undefined)} A possible error
   * @private
   */
  controlMessage(data, cb) {
    if (this._opcode === 0x08) {
      if (data.length === 0) {
        this._loop = false;
        this.emit('conclude', 1005, EMPTY_BUFFER);
        this.end();
      } else {
        const code = data.readUInt16BE(0);

        if (!isValidStatusCode(code)) {
          const error = this.createError(
            RangeError,
            `invalid status code ${code}`,
            true,
            1002,
            'WS_ERR_INVALID_CLOSE_CODE'
          );

          cb(error);
          return;
        }

        const buf = new FastBuffer(
          data.buffer,
          data.byteOffset + 2,
          data.length - 2
        );

        if (!this._skipUTF8Validation &amp;&amp; !isValidUTF8(buf)) {
          const error = this.createError(
            Error,
            'invalid UTF-8 sequence',
            true,
            1007,
            'WS_ERR_INVALID_UTF8'
          );

          cb(error);
          return;
        }

        this._loop = false;
        this.emit('conclude', code, buf);
        this.end();
      }

      this._state = GET_INFO;
      return;
    }

    if (this._allowSynchronousEvents) {
      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);
      this._state = GET_INFO;
    } else {
      this._state = DEFER_EVENT;
      setImmediate(() => {
        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);
        this._state = GET_INFO;
        this.startLoop(cb);
      });
    }
  }

  /**
   * Builds an error object.
   *
   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor
   * @param {String} message The error message
   * @param {Boolean} prefix Specifies whether or not to add a default prefix to
   *     `message`
   * @param {Number} statusCode The status code
   * @param {String} errorCode The exposed error code
   * @return {(Error|RangeError)} The error
   * @private
   */
  createError(ErrorCtor, message, prefix, statusCode, errorCode) {
    this._loop = false;
    this._errored = true;

    const err = new ErrorCtor(
      prefix ? `Invalid WebSocket frame: ${message}` : message
    );

    Error.captureStackTrace(err, this.createError);
    err.code = errorCode;
    err[kStatusCode] = statusCode;
    return err;
  }
}

module.exports = Receiver;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AuthWeakPasswordError.html">AuthWeakPasswordError</a></li><li><a href="CloseEvent.html">CloseEvent</a></li><li><a href="ContentDisposition.html">ContentDisposition</a></li><li><a href="Deferred.html">Deferred</a></li><li><a href="ErrorEvent.html">ErrorEvent</a></li><li><a href="Event.html">Event</a></li><li><a href="GoTrueClient.html">GoTrueClient</a></li><li><a href="Headers.html">Headers</a></li><li><a href="Limiter.html">Limiter</a></li><li><a href="LockAcquireTimeoutError.html">LockAcquireTimeoutError</a></li><li><a href="MessageEvent.html">MessageEvent</a></li><li><a href="PerMessageDeflate.html">PerMessageDeflate</a></li><li><a href="PostgrestClient.html">PostgrestClient</a></li><li><a href="PostgrestError.html">PostgrestError</a></li><li><a href="Push.html">Push</a></li><li><a href="RealtimeChannel.html">RealtimeChannel</a></li><li><a href="RealtimeClient.html">RealtimeClient</a></li><li><a href="RealtimePresence.html">RealtimePresence</a></li><li><a href="Receiver.html">Receiver</a></li><li><a href="Request.html">Request</a></li><li><a href="Response.html">Response</a></li><li><a href="Sender.html">Sender</a></li><li><a href="SupabaseClient.html">SupabaseClient</a></li><li><a href="Timer.html">Timer</a></li><li><a href="TokenData.html">TokenData</a></li><li><a href="WebSocket.html">WebSocket</a></li><li><a href="WebSocketServer.html">WebSocketServer</a></li><li><a href="module.html#.exports">exports</a></li><li><a href="module.exports_module.exports.html">exports</a></li></ul><h3>Mixins</h3><ul><li><a href="EventTarget.html">EventTarget</a></li></ul><h3>Global</h3><ul><li><a href="global.html"></a></li><li><a href="global.html#$defineProperty">$defineProperty</a></li><li><a href="global.html#$gOPD">$gOPD</a></li><li><a href="global.html#$indexOf">$indexOf</a></li><li><a href="global.html#$mapDelete">$mapDelete</a></li><li><a href="global.html#$mapGet">$mapGet</a></li><li><a href="global.html#$mapHas">$mapHas</a></li><li><a href="global.html#$mapSet">$mapSet</a></li><li><a href="global.html#$mapSize">$mapSize</a></li><li><a href="global.html#$weakMapDelete">$weakMapDelete</a></li><li><a href="global.html#$weakMapGet">$weakMapGet</a></li><li><a href="global.html#$weakMapHas">$weakMapHas</a></li><li><a href="global.html#$weakMapSet">$weakMapSet</a></li><li><a href="global.html#API_VERSION_REGEX">API_VERSION_REGEX</a></li><li><a href="global.html#AUTO_REFRESH_TICK_DURATION_MS">AUTO_REFRESH_TICK_DURATION_MS</a></li><li><a href="global.html#AUTO_REFRESH_TICK_THRESHOLD">AUTO_REFRESH_TICK_THRESHOLD</a></li><li><a href="global.html#AbortError">AbortError</a></li><li><a href="global.html#Accepts">Accepts</a></li><li><a href="global.html#Body">Body</a></li><li><a href="global.html#DeprecationError">DeprecationError</a></li><li><a href="global.html#FIELD_NAME_REGEXP">FIELD_NAME_REGEXP</a></li><li><a href="global.html#FIRST_CHAR_REGEXP">FIRST_CHAR_REGEXP</a></li><li><a href="global.html#FROM_BASE64URL">FROM_BASE64URL</a></li><li><a href="global.html#FetchError">FetchError</a></li><li><a href="global.html#GLOBAL_JWKS">GLOBAL_JWKS</a></li><li><a href="global.html#IGNORE_BASE64URL">IGNORE_BASE64URL</a></li><li><a href="global.html#MediaType">MediaType</a></li><li><a href="global.html#Negotiator">Negotiator</a></li><li><a href="global.html#PARAM_REGEXP">PARAM_REGEXP</a></li><li><a href="global.html#QESC_REGEXP">QESC_REGEXP</a></li><li><a href="global.html#QUOTE_REGEXP">QUOTE_REGEXP</a></li><li><a href="global.html#Route">Route</a></li><li><a href="global.html#Router">Router</a></li><li><a href="global.html#SUBTYPE_NAME_REGEXP">SUBTYPE_NAME_REGEXP</a></li><li><a href="global.html#TO_BASE64URL">TO_BASE64URL</a></li><li><a href="global.html#TYPE_REGEXP">TYPE_REGEXP</a></li><li><a href="global.html#View">View</a></li><li><a href="global.html#__loadSession">__loadSession</a></li><li><a href="global.html#_acquireLock">_acquireLock</a></li><li><a href="global.html#_appendParams">_appendParams</a></li><li><a href="global.html#_autoRefreshTokenTick">_autoRefreshTokenTick</a></li><li><a href="global.html#_canPush">_canPush</a></li><li><a href="global.html#_challenge">_challenge</a></li><li><a href="global.html#_challengeAndVerify">_challengeAndVerify</a></li><li><a href="global.html#_fetchWithTimeout">_fetchWithTimeout</a></li><li><a href="global.html#_getAuthenticatorAssuranceLevel">_getAuthenticatorAssuranceLevel</a></li><li><a href="global.html#_getPayloadRecords">_getPayloadRecords</a></li><li><a href="global.html#_getSessionFromURL">_getSessionFromURL</a></li><li><a href="global.html#_getUrlForProvider">_getUrlForProvider</a></li><li><a href="global.html#_handleVisibilityChange">_handleVisibilityChange</a></li><li><a href="global.html#_initialize">_initialize</a></li><li><a href="global.html#_isClosed">_isClosed</a></li><li><a href="global.html#_isImplicitGrantCallback">_isImplicitGrantCallback</a></li><li><a href="global.html#_isJoined">_isJoined</a></li><li><a href="global.html#_isJoining">_isJoining</a></li><li><a href="global.html#_isLeaving">_isLeaving</a></li><li><a href="global.html#_isMember">_isMember</a></li><li><a href="global.html#_isPKCECallback">_isPKCECallback</a></li><li><a href="global.html#_isValidUTF8">_isValidUTF8</a></li><li><a href="global.html#_joinRef">_joinRef</a></li><li><a href="global.html#_leaveOpenTopic">_leaveOpenTopic</a></li><li><a href="global.html#_listFactors">_listFactors</a></li><li><a href="global.html#_makeRef">_makeRef</a></li><li><a href="global.html#_mask">_mask</a></li><li><a href="global.html#_off">_off</a></li><li><a href="global.html#_on">_on</a></li><li><a href="global.html#_onClose">_onClose</a></li><li><a href="global.html#_onConnClose">_onConnClose</a></li><li><a href="global.html#_onConnError">_onConnError</a></li><li><a href="global.html#_onConnMessage">_onConnMessage</a></li><li><a href="global.html#_onConnOpen">_onConnOpen</a></li><li><a href="global.html#_onError">_onError</a></li><li><a href="global.html#_onMessage">_onMessage</a></li><li><a href="global.html#_onVisibilityChanged">_onVisibilityChanged</a></li><li><a href="global.html#_push">_push</a></li><li><a href="global.html#_recoverAndRefresh">_recoverAndRefresh</a></li><li><a href="global.html#_refreshAccessToken">_refreshAccessToken</a></li><li><a href="global.html#_rejoin">_rejoin</a></li><li><a href="global.html#_rejoinUntilConnected">_rejoinUntilConnected</a></li><li><a href="global.html#_remove">_remove</a></li><li><a href="global.html#_removeVisibilityChangedCallback">_removeVisibilityChangedCallback</a></li><li><a href="global.html#_replyEventName">_replyEventName</a></li><li><a href="global.html#_saveSession">_saveSession</a></li><li><a href="global.html#_startAutoRefresh">_startAutoRefresh</a></li><li><a href="global.html#_startHeartbeat">_startHeartbeat</a></li><li><a href="global.html#_startWorkerHeartbeat">_startWorkerHeartbeat</a></li><li><a href="global.html#_stopAutoRefresh">_stopAutoRefresh</a></li><li><a href="global.html#_trigger">_trigger</a></li><li><a href="global.html#_triggerChanError">_triggerChanError</a></li><li><a href="global.html#_unmask">_unmask</a></li><li><a href="global.html#_useSession">_useSession</a></li><li><a href="global.html#_verify">_verify</a></li><li><a href="global.html#acceptParams">acceptParams</a></li><li><a href="global.html#alladdrs">alladdrs</a></li><li><a href="global.html#app">app</a></li><li><a href="global.html#append">append</a></li><li><a href="global.html#application">application</a></li><li><a href="global.html#base64UrlToUint8Array">base64UrlToUint8Array</a></li><li><a href="global.html#basePath">basePath</a></li><li><a href="global.html#bodyParser">bodyParser</a></li><li><a href="global.html#byteFromBase64URL">byteFromBase64URL</a></li><li><a href="global.html#byteToBase64URL">byteToBase64URL</a></li><li><a href="global.html#bytes">bytes</a></li><li><a href="global.html#callSiteLocation">callSiteLocation</a></li><li><a href="global.html#channel">channel</a></li><li><a href="global.html#charset">charset</a></li><li><a href="global.html#clone">clone</a></li><li><a href="global.html#cloneDeep">cloneDeep</a></li><li><a href="global.html#codepointToUTF8">codepointToUTF8</a></li><li><a href="global.html#colors">colors</a></li><li><a href="global.html#compile">compile</a></li><li><a href="global.html#compileETag">compileETag</a></li><li><a href="global.html#compileQueryParser">compileQueryParser</a></li><li><a href="global.html#compileTrust">compileTrust</a></li><li><a href="global.html#concat">concat</a></li><li><a href="global.html#connect">connect</a></li><li><a href="global.html#connectionState">connectionState</a></li><li><a href="global.html#consumeBody">consumeBody</a></li><li><a href="global.html#containsDotFile">containsDotFile</a></li><li><a href="global.html#containsNamespace">containsNamespace</a></li><li><a href="global.html#contentDisposition">contentDisposition</a></li><li><a href="global.html#contentRange">contentRange</a></li><li><a href="global.html#contentType">contentType</a></li><li><a href="global.html#contentstream">contentstream</a></li><li><a href="global.html#convertBody">convertBody</a></li><li><a href="global.html#convertCell">convertCell</a></li><li><a href="global.html#convertChangeData">convertChangeData</a></li><li><a href="global.html#convertColumn">convertColumn</a></li><li><a href="global.html#convertDataDescriptorToAccessor">convertDataDescriptorToAccessor</a></li><li><a href="global.html#cookieNameRegExp">cookieNameRegExp</a></li><li><a href="global.html#cookieValueRegExp">cookieValueRegExp</a></li><li><a href="global.html#copy">copy</a></li><li><a href="global.html#createApplication">createApplication</a></li><li><a href="global.html#createArgumentsString">createArgumentsString</a></li><li><a href="global.html#createBucket">createBucket</a></li><li><a href="global.html#createClient">createClient</a></li><li><a href="global.html#createDecompressionStream">createDecompressionStream</a></li><li><a href="global.html#createError">createError</a></li><li><a href="global.html#createHeadersLenient">createHeadersLenient</a></li><li><a href="global.html#createQueryParser">createQueryParser</a></li><li><a href="global.html#createSignedUploadUrl">createSignedUploadUrl</a></li><li><a href="global.html#createSignedUrl">createSignedUrl</a></li><li><a href="global.html#createSignedUrls">createSignedUrls</a></li><li><a href="global.html#createStackString">createStackString</a></li><li><a href="global.html#createUser">createUser</a></li><li><a href="global.html#createWebSocketStream">createWebSocketStream</a></li><li><a href="global.html#crypto">crypto</a></li><li><a href="global.html#debug">debug</a></li><li><a href="global.html#decode">decode</a></li><li><a href="global.html#deepClone">deepClone</a></li><li><a href="global.html#defaultMessage">defaultMessage</a></li><li><a href="global.html#deleteBucket">deleteBucket</a></li><li><a href="global.html#deleteUser">deleteUser</a></li><li><a href="global.html#depd">depd</a></li><li><a href="global.html#disconnect">disconnect</a></li><li><a href="global.html#domainValueRegExp">domainValueRegExp</a></li><li><a href="global.html#download">download</a></li><li><a href="global.html#dump">dump</a></li><li><a href="global.html#emptyBucket">emptyBucket</a></li><li><a href="global.html#encodeUrl">encodeUrl</a></li><li><a href="global.html#endpointURL">endpointURL</a></li><li><a href="global.html#escape">escape</a></li><li><a href="global.html#escapeHtml">escapeHtml</a></li><li><a href="global.html#escapeText">escapeText</a></li><li><a href="global.html#etag">etag</a></li><li><a href="global.html#exchangeCodeForSession">exchangeCodeForSession</a></li><li><a href="global.html#exists">exists</a></li><li><a href="global.html#exportNodeCompatibleHeaders">exportNodeCompatibleHeaders</a></li><li><a href="global.html#extension">extension</a></li><li><a href="global.html#extractContentType">extractContentType</a></li><li><a href="global.html#fetch">fetch</a></li><li><a href="global.html#finalhandler">finalhandler</a></li><li><a href="global.html#find">find</a></li><li><a href="global.html#first">first</a></li><li><a href="global.html#flatten">flatten</a></li><li><a href="global.html#flushSendBuffer">flushSendBuffer</a></li><li><a href="global.html#fmtLong">fmtLong</a></li><li><a href="global.html#fmtShort">fmtShort</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#formatArgs">formatArgs</a></li><li><a href="global.html#formatColor">formatColor</a></li><li><a href="global.html#formatLocation">formatLocation</a></li><li><a href="global.html#formatPlain">formatPlain</a></li><li><a href="global.html#forwarded">forwarded</a></li><li><a href="global.html#fresh">fresh</a></li><li><a href="global.html#from">from</a></li><li><a href="global.html#functions">functions</a></li><li><a href="global.html#generateLink">generateLink</a></li><li><a href="global.html#getBucket">getBucket</a></li><li><a href="global.html#getChannels">getChannels</a></li><li><a href="global.html#getCharset">getCharset</a></li><li><a href="global.html#getClaims">getClaims</a></li><li><a href="global.html#getNodeRequestOptions">getNodeRequestOptions</a></li><li><a href="global.html#getPublicUrl">getPublicUrl</a></li><li><a href="global.html#getRawBody">getRawBody</a></li><li><a href="global.html#getSession">getSession</a></li><li><a href="global.html#getStack">getStack</a></li><li><a href="global.html#getTotalBytes">getTotalBytes</a></li><li><a href="global.html#getUser">getUser</a></li><li><a href="global.html#getUserById">getUserById</a></li><li><a href="global.html#getUserIdentities">getUserIdentities</a></li><li><a href="global.html#hasSession">hasSession</a></li><li><a href="global.html#hasbody">hasbody</a></li><li><a href="global.html#inPendingSyncState">inPendingSyncState</a></li><li><a href="global.html#info">info</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initialize">initialize</a></li><li><a href="global.html#inspectOpts">inspectOpts</a></li><li><a href="global.html#internals">internals</a></li><li><a href="global.html#invalidTokenRegex">invalidTokenRegex</a></li><li><a href="global.html#inviteUserByEmail">inviteUserByEmail</a></li><li><a href="global.html#isBlob">isBlob</a></li><li><a href="global.html#isConnected">isConnected</a></li><li><a href="global.html#isEqual">isEqual</a></li><li><a href="global.html#isFinished">isFinished</a></li><li><a href="global.html#isRequest">isRequest</a></li><li><a href="global.html#isSameProtocol">isSameProtocol</a></li><li><a href="global.html#isURLSearchParams">isURLSearchParams</a></li><li><a href="global.html#isValidStatusCode">isValidStatusCode</a></li><li><a href="global.html#isignored">isignored</a></li><li><a href="global.html#isstats">isstats</a></li><li><a href="global.html#istraced">istraced</a></li><li><a href="global.html#json">json</a></li><li><a href="global.html#jwks">jwks</a></li><li><a href="global.html#lexer">lexer</a></li><li><a href="global.html#linkIdentity">linkIdentity</a></li><li><a href="global.html#list">list</a></li><li><a href="global.html#listBuckets">listBuckets</a></li><li><a href="global.html#listDelete">listDelete</a></li><li><a href="global.html#listGet">listGet</a></li><li><a href="global.html#listGetNode">listGetNode</a></li><li><a href="global.html#listHas">listHas</a></li><li><a href="global.html#listSet">listSet</a></li><li><a href="global.html#listUsers">listUsers</a></li><li><a href="global.html#load">load</a></li><li><a href="global.html#localstorage">localstorage</a></li><li><a href="global.html#log">log</a></li><li><a href="global.html#lookup">lookup</a></li><li><a href="global.html#loosen">loosen</a></li><li><a href="global.html#map">map</a></li><li><a href="global.html#match">match</a></li><li><a href="global.html#memoryLocalStorageAdapter">memoryLocalStorageAdapter</a></li><li><a href="global.html#methods">methods</a></li><li><a href="global.html#mimeMatch">mimeMatch</a></li><li><a href="global.html#move">move</a></li><li><a href="global.html#navigatorLock">navigatorLock</a></li><li><a href="global.html#normalize">normalize</a></li><li><a href="global.html#normalizeJsonSyntaxError">normalizeJsonSyntaxError</a></li><li><a href="global.html#normalizeOptions">normalizeOptions</a></li><li><a href="global.html#normalizeType">normalizeType</a></li><li><a href="global.html#normalizeTypes">normalizeTypes</a></li><li><a href="global.html#obj">obj</a></li><li><a href="global.html#onAuthStateChange">onAuthStateChange</a></li><li><a href="global.html#onFinished">onFinished</a></li><li><a href="global.html#onJoin">onJoin</a></li><li><a href="global.html#onLeave">onLeave</a></li><li><a href="global.html#onSync">onSync</a></li><li><a href="global.html#originalurl">originalurl</a></li><li><a href="global.html#parameterCount">parameterCount</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#parseParametersFromURL">parseParametersFromURL</a></li><li><a href="global.html#parseURL">parseURL</a></li><li><a href="global.html#parseurl">parseurl</a></li><li><a href="global.html#pathValueRegExp">pathValueRegExp</a></li><li><a href="global.html#plural">plural</a></li><li><a href="global.html#polyfillGlobalThis">polyfillGlobalThis</a></li><li><a href="global.html#preferredCharsets">preferredCharsets</a></li><li><a href="global.html#preferredEncodings">preferredEncodings</a></li><li><a href="global.html#preferredLanguages">preferredLanguages</a></li><li><a href="global.html#preferredMediaTypes">preferredMediaTypes</a></li><li><a href="global.html#prepareObjectStackTrace">prepareObjectStackTrace</a></li><li><a href="global.html#processLock">processLock</a></li><li><a href="global.html#proxyaddr">proxyaddr</a></li><li><a href="global.html#push">push</a></li><li><a href="global.html#rangeParser">rangeParser</a></li><li><a href="global.html#raw">raw</a></li><li><a href="global.html#readStream">readStream</a></li><li><a href="global.html#reauthenticate">reauthenticate</a></li><li><a href="global.html#refreshSession">refreshSession</a></li><li><a href="global.html#relative">relative</a></li><li><a href="global.html#remove">remove</a></li><li><a href="global.html#removeAllChannels">removeAllChannels</a></li><li><a href="global.html#removeChannel">removeChannel</a></li><li><a href="global.html#req">req</a></li><li><a href="global.html#res">res</a></li><li><a href="global.html#resend">resend</a></li><li><a href="global.html#resetPasswordForEmail">resetPasswordForEmail</a></li><li><a href="global.html#retryable">retryable</a></li><li><a href="global.html#rpc">rpc</a></li><li><a href="global.html#s">s</a></li><li><a href="global.html#save">save</a></li><li><a href="global.html#schema">schema</a></li><li><a href="global.html#send">send</a></li><li><a href="global.html#sendHeartbeat">sendHeartbeat</a></li><li><a href="global.html#sequenceToRegExp">sequenceToRegExp</a></li><li><a href="global.html#serialize">serialize</a></li><li><a href="global.html#serveStatic">serveStatic</a></li><li><a href="global.html#setAuth">setAuth</a></li><li><a href="global.html#setCharset">setCharset</a></li><li><a href="global.html#setSession">setSession</a></li><li><a href="global.html#setup">setup</a></li><li><a href="global.html#setupConnection">setupConnection</a></li><li><a href="global.html#sign">sign</a></li><li><a href="global.html#signInAnonymously">signInAnonymously</a></li><li><a href="global.html#signInWithIdToken">signInWithIdToken</a></li><li><a href="global.html#signInWithOAuth">signInWithOAuth</a></li><li><a href="global.html#signInWithOtp">signInWithOtp</a></li><li><a href="global.html#signInWithPassword">signInWithPassword</a></li><li><a href="global.html#signInWithSSO">signInWithSSO</a></li><li><a href="global.html#signInWithWeb3">signInWithWeb3</a></li><li><a href="global.html#signOut">signOut</a></li><li><a href="global.html#signUp">signUp</a></li><li><a href="global.html#sleep">sleep</a></li><li><a href="global.html#startAutoRefresh">startAutoRefresh</a></li><li><a href="global.html#status">status</a></li><li><a href="global.html#stopAutoRefresh">stopAutoRefresh</a></li><li><a href="global.html#storage">storage</a></li><li><a href="global.html#stringFromBase64URL">stringFromBase64URL</a></li><li><a href="global.html#stringFromUTF8">stringFromUTF8</a></li><li><a href="global.html#stringToBase64URL">stringToBase64URL</a></li><li><a href="global.html#stringToPath">stringToPath</a></li><li><a href="global.html#stringToUTF8">stringToUTF8</a></li><li><a href="global.html#stringify">stringify</a></li><li><a href="global.html#subscribe">subscribe</a></li><li><a href="global.html#supportsLocalStorage">supportsLocalStorage</a></li><li><a href="global.html#syncDiff">syncDiff</a></li><li><a href="global.html#syncState">syncState</a></li><li><a href="global.html#teardown">teardown</a></li><li><a href="global.html#test">test</a></li><li><a href="global.html#text">text</a></li><li><a href="global.html#toArray">toArray</a></li><li><a href="global.html#toArrayBuffer">toArrayBuffer</a></li><li><a href="global.html#toBuffer">toBuffer</a></li><li><a href="global.html#toIdentifier">toIdentifier</a></li><li><a href="global.html#toTimestampString">toTimestampString</a></li><li><a href="global.html#tokenToFunction">tokenToFunction</a></li><li><a href="global.html#transformState">transformState</a></li><li><a href="global.html#tty">tty</a></li><li><a href="global.html#typeChecker">typeChecker</a></li><li><a href="global.html#typeis">typeis</a></li><li><a href="global.html#typeofrequest">typeofrequest</a></li><li><a href="global.html#unlinkIdentity">unlinkIdentity</a></li><li><a href="global.html#unpipe">unpipe</a></li><li><a href="global.html#unsign">unsign</a></li><li><a href="global.html#unsubscribe">unsubscribe</a></li><li><a href="global.html#update">update</a></li><li><a href="global.html#updateBucket">updateBucket</a></li><li><a href="global.html#updateUser">updateUser</a></li><li><a href="global.html#updateUserById">updateUserById</a></li><li><a href="global.html#upload">upload</a></li><li><a href="global.html#uploadOrUpdate">uploadOrUpdate</a></li><li><a href="global.html#uploadToSignedUrl">uploadToSignedUrl</a></li><li><a href="global.html#urlencoded">urlencoded</a></li><li><a href="global.html#useColors">useColors</a></li><li><a href="global.html#vary">vary</a></li><li><a href="global.html#verifyOtp">verifyOtp</a></li><li><a href="global.html#wetag">wetag</a></li><li><a href="global.html#wrapfunction">wrapfunction</a></li><li><a href="global.html#wrapproperty">wrapproperty</a></li><li><a href="global.html#writeToStream">writeToStream</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Wed Aug 13 2025 20:57:10 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
